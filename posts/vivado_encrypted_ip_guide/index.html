<!doctype html><html lang=en-us><head><meta charset=UTF-8><meta name=viewport content="width=device-width,initial-scale=1"><meta http-equiv=X-UA-Compatible content="IE=edge"><style type=text/css>body{font-family:monospace}</style><title>Vivado加密IP</title><link href="https://fonts.googleapis.com/css2?family=Noto+Sans+SC:wght@400;700&display=swap" rel=stylesheet><link rel=stylesheet href=/css/style.css></head><body><header>===================<br>== <a href=https://lxulxu.github.io/>lxulxu's blog</a> ==<br>===================<div style=float:right>Hello there</div><br><p><nav><a href=/><b>Start</b></a>.
<a href=/posts/><b>Posts</b></a>.
<a href=/categories/><b>Categories</b></a>.
<a href=/tags/><b>Tags</b></a>.
<a href=/about/><b>About</b></a>.</nav></p></header><main><article><h1>Vivado加密IP</h1><b><time>26.03.2022 18:00</time></b>
<a href=/tags/xilinx>xilinx</a><div><p>整理 UG1118 Ch6</p><h2 id=权限管理>权限管理</h2><ul><li><p><strong>公共权限(Common Rights)</strong>：适用于所有EDA工具</p></li><li><p><strong>特定权限(Vendor-Specific Rights)</strong>：授予开发者的特定权限（如控制Vivado Logic Analyzer探测器行为），此部分访问权限值覆盖普通权限同名值</p></li><li><p><strong>条件权限(Conditional Rights)</strong>：IEEE-1735-2014 V2 引入，允许不同条件下指定不同访问权限</p></li></ul><hr><h2 id=ieee-1735-结构>IEEE 1735 结构</h2><ul><li><p><strong>定义域(Definition area)</strong>：定义支持的供应商及其访问权限</p></li><li><p><strong>密钥定义(Encrypted Key Definition)</strong></p></li><li><p><strong>加密负载(Encrypted payload)</strong>：加密IP的Verilog、System Verilog、 VHDL源码</p></li><li><p><strong>纯文本负载(Plain-text payload)</strong>：IP源码未加密部分</p></li></ul><p>以一个完整密钥文件内容为例</p><div class=highlight><pre tabindex=0 style=color:#ebdbb2;background-color:#282828;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#756d59"> 1</span><span>`pragma protect version <span style=color:#fe8019>=</span> <span style=color:#d3869b>2</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#756d59"> 2</span><span>`pragma protect encrypt_agent <span style=color:#fe8019>=</span> <span style=color:#b8bb26>&#34;XILINX&#34;</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#756d59"> 3</span><span>`pragma protect encrypt_agent_info <span style=color:#fe8019>=</span> <span style=color:#b8bb26>&#34;Xilinx Encryption Tool 2021&#34;</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#756d59"> 4</span><span>`pragma protect begin_commonblock
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#756d59"> 5</span><span>`pragma protect control error_handling <span style=color:#fe8019>=</span> <span style=color:#b8bb26>&#34;delegated&#34;</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#756d59"> 6</span><span>`pragma protect control child_visibility <span style=color:#fe8019>=</span> <span style=color:#b8bb26>&#34;delegated&#34;</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#756d59"> 7</span><span>`pragma protect control decryption <span style=color:#fe8019>=</span> (activity<span style=color:#fe8019>==</span>simulation)? <span style=color:#b8bb26>&#34;false&#34;</span> :<span style=color:#b8bb26>&#34;true&#34;</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#756d59"> 8</span><span>`pragma protect end_commonblock
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#756d59"> 9</span><span>`pragma protect begin_toolblock
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#756d59">10</span><span>`pragma protect rights_digest_method<span style=color:#fe8019>=</span><span style=color:#b8bb26>&#34;sha256&#34;</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#756d59">11</span><span>`pragma protect key_keyowner <span style=color:#fe8019>=</span> <span style=color:#b8bb26>&#34;Xilinx&#34;</span>, key_keyname<span style=color:#fe8019>=</span> <span style=color:#b8bb26>&#34;xilinxt_2021_01&#34;</span>, key_method <span style=color:#fe8019>=</span> <span style=color:#b8bb26>&#34;rsa&#34;</span>, key_public_key
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#756d59">12</span><span>MIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEApgf7F4kYh0oSFzJBRoRb
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#756d59">13</span><span>nsrAqn24fVbI7xdNG2t9G8pouFfwIXGGmQgYqYZDSmUu0wrrj3ulLvUnjRtmtziJ
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#756d59">14</span><span><span style=color:#d3869b>1</span>RDOYdyko1SuBEyGT1frzUu9xNitAXxp29hOrVPeKO6kGU81XHJCRJ7uWh7rwoyf
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#756d59">15</span><span>HSUpreifLybt<span style=color:#fe8019>+</span>UT5fyvHu21IxvOR6GHKWaQ4wdL7Txguuyf92XLJIZABEgmuVlPK
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#756d59">16</span><span><span style=color:#fe8019>/</span>NjJjVRK3c<span style=color:#fe8019>/</span>vMuQLvbihNapkyCiLIWNwDbo9oWXr7NSo3we8u6IlFmP5V8WcOmXZ
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#756d59">17</span><span><span style=color:#fe8019>/</span>PZqp3QOkY2Jlm1yQt3O8PpU<span style=color:#fe8019>/</span><span style=color:#d3869b>8</span>qzB7zcHjm3<span style=color:#fe8019>+</span>Q<span style=color:#fe8019>+</span>wB8yUYn<span style=color:#fe8019>/</span>IMwN0t09l2AdBR37G
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#756d59">18</span><span>EwIDAQAB
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#756d59">19</span><span>`pragma protect control xilinx_configuration_visible <span style=color:#fe8019>=</span> <span style=color:#b8bb26>&#34;false&#34;</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#756d59">20</span><span>`pragma protect control xilinx_enable_modification <span style=color:#fe8019>=</span> <span style=color:#b8bb26>&#34;false&#34;</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#756d59">21</span><span>`pragma protect control xilinx_enable_probing <span style=color:#fe8019>=</span> <span style=color:#b8bb26>&#34;false&#34;</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#756d59">22</span><span>`pragma protect control xilinx_enable_netlist_export <span style=color:#fe8019>=</span> <span style=color:#b8bb26>&#34;false&#34;</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#756d59">23</span><span>`pragma protect control xilinx_enable_bitstream <span style=color:#fe8019>=</span> <span style=color:#b8bb26>&#34;true&#34;</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#756d59">24</span><span>`pragma protect control decryption <span style=color:#fe8019>=</span> (xilinx_activity<span style=color:#fe8019>==</span>simulation)?<span style=color:#b8bb26>&#34;false&#34;</span> : <span style=color:#b8bb26>&#34;true&#34;</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#756d59">25</span><span>`pragma protect end_toolblock <span style=color:#fe8019>=</span> <span style=color:#b8bb26>&#34;&#34;</span>
</span></span></code></pre></div><h3 id=版本或其他杂注>版本或其他杂注</h3><div class=highlight><pre tabindex=0 style=color:#ebdbb2;background-color:#282828;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#756d59">1</span><span>`pragma protect version <span style=color:#fe8019>=</span> <span style=color:#d3869b>2</span>` <span style=color:#928374;font-style:italic>#遵从IEEE-1735-2014 V2标准</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#756d59">2</span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#756d59">3</span><span> <span style=color:#928374;font-style:italic>#标识加密工具</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#756d59">4</span><span>`pragma protect encrypt_agent <span style=color:#fe8019>=</span> <span style=color:#b8bb26>&#34;XILINX&#34;</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#756d59">5</span><span>`pragma protect encrypt_agent_info <span style=color:#fe8019>=</span> <span style=color:#b8bb26>&#34;Xilinx Encryption Tool 2021&#34;</span>
</span></span></code></pre></div><h3 id=公共权限common-block-definition>公共权限(Common Block Definition)</h3><div class=highlight><pre tabindex=0 style=color:#ebdbb2;background-color:#282828;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#756d59">1</span><span>`pragma protect begin_commonblock
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#756d59">2</span><span><span style=color:#fe8019>...</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#756d59">3</span><span>`pragma protect end_commonblock
</span></span></code></pre></div><p>公共权限列表</p><table><thead><tr><th style=text-align:center>名称</th><th style=text-align:center>含义</th><th style=text-align:center>默认值</th><th style=text-align:center>有效值</th><th style=text-align:center>Xlinx有效值</th></tr></thead><tbody><tr><td style=text-align:center>error_handling</td><td style=text-align:center>允许展示的错误信息</td><td style=text-align:center>&ldquo;delegated&rdquo;</td><td style=text-align:center>&ldquo;delegated&rdquo;<br>&ldquo;srcrefs&rdquo;<br>&ldquo;plaintext&rdquo;</td><td style=text-align:center>&ldquo;delegated&rdquo;</td></tr><tr><td style=text-align:center>runtime_visibility</td><td style=text-align:center>运行、tcl或输出报告允许展示的内容</td><td style=text-align:center>&ldquo;delegated&rdquo;</td><td style=text-align:center>&ldquo;delegated&rdquo;<br>&ldquo;interface_names&rdquo;<br>&ldquo;all_names&rdquo;</td><td style=text-align:center>&ldquo;delegated&rdquo;</td></tr><tr><td style=text-align:center>child_visibility</td><td style=text-align:center>受保护模块实例化未受保护子模块，子模块如何处理error_handling和runtime_visibility<br>显示消息可能会通过受保护区域公开路径名</td><td style=text-align:center>&ldquo;delegated&rdquo;</td><td style=text-align:center>&ldquo;delegated&rdquo;<br>&ldquo;allowed&rdquo;<br>&ldquo;denied&rdquo;</td><td style=text-align:center>&ldquo;delegated&rdquo;<br>&ldquo;allowed&rdquo;</td></tr><tr><td style=text-align:center>decryption</td><td style=text-align:center>是否允许解密模块，一般用于条件权限</td><td style=text-align:center>&ldquo;delegated&rdquo;</td><td style=text-align:center>&ldquo;delegated&rdquo;<br>&ldquo;true&rdquo;<br>&ldquo;false&rdquo;</td><td style=text-align:center>&ldquo;delegated&rdquo;<br>&ldquo;true&rdquo;<br>&ldquo;false&rdquo;<br><strong>Note:</strong>&ldquo;delegated&rdquo;=&ldquo;true&rdquo;</td></tr></tbody></table><h3 id=特定权限vendor-specific-tool-block-definition>特定权限(Vendor-Specific Tool Block Definition)</h3><div class=highlight><pre tabindex=0 style=color:#ebdbb2;background-color:#282828;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#756d59">1</span><span>`pragma protect begin_toolblock
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#756d59">2</span><span><span style=color:#fe8019>...</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#756d59">3</span><span>`pragma protect end_toolblock <span style=color:#fe8019>=</span> <span style=color:#b8bb26>&#34;&#34;</span>
</span></span></code></pre></div><p>特定权限列表</p><table><thead><tr><th style=text-align:center>名称</th><th style=text-align:center>含义</th><th style=text-align:center>Xlinx有效值</th><th style=text-align:center>默认值</th></tr></thead><tbody><tr><td style=text-align:center>xilinx_configuration_visible</td><td style=text-align:center>LUT值在Vivado viewers/editors中是否可见</td><td style=text-align:center>&ldquo;true&rdquo;, &ldquo;false&rdquo;</td><td style=text-align:center>&ldquo;false&rdquo;</td></tr><tr><td style=text-align:center>xilinx_enable_modification</td><td style=text-align:center>受保护区域网表信息是否可修改</td><td style=text-align:center>&ldquo;true&rdquo;, &ldquo;false&rdquo;</td><td style=text-align:center>&ldquo;false&rdquo;</td></tr><tr><td style=text-align:center>xilinx_enable_probing</td><td style=text-align:center>用户可否在受保护区域插入或实例化调试探针</td><td style=text-align:center>&ldquo;true&rdquo;, &ldquo;false&rdquo;</td><td style=text-align:center>&ldquo;false&rdquo;</td></tr><tr><td style=text-align:center>xilinx_enable_netlist_export</td><td style=text-align:center>是否允许导出网表信息</td><td style=text-align:center>&ldquo;true&rdquo;, &ldquo;false&rdquo;</td><td style=text-align:center>&ldquo;true&rdquo;</td></tr><tr><td style=text-align:center>xilinx_enable_bitstream</td><td style=text-align:center>是否允许生成比特流</td><td style=text-align:center>&ldquo;true&rdquo;, &ldquo;false&rdquo;</td><td style=text-align:center>&ldquo;true&rdquo;</td></tr><tr><td style=text-align:center>xilinx_schematic_visibility</td><td style=text-align:center>是否允许展示受保护区域模块名称</td><td style=text-align:center>&ldquo;true&rdquo;, &ldquo;false&rdquo;</td><td style=text-align:center>&ldquo;false&rdquo;</td></tr></tbody></table><h3 id=密钥定义和权限摘要key-definition-and-rights-digest-method>密钥定义和权限摘要(Key Definition and Rights Digest Method)</h3><p>强制性定义，包括公钥、密钥相关属性和权限计算方法</p><div class=highlight><pre tabindex=0 style=color:#ebdbb2;background-color:#282828;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#756d59">1</span><span>`protect key_keyowner <span style=color:#fe8019>=</span> <span style=color:#b8bb26>&#34;Xilinx&#34;</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#756d59">2</span><span>`protect key_method <span style=color:#fe8019>=</span> <span style=color:#b8bb26>&#34;rsa&#34;</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#756d59">3</span><span>`protect key_keyname <span style=color:#fe8019>=</span> <span style=color:#b8bb26>&#34;xilinxt_2019_11&#34;</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#756d59">4</span><span>`protect rights_digest_method <span style=color:#fe8019>=</span> <span style=color:#b8bb26>&#34;sha256&#34;</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#756d59">5</span><span>`protect key_public_key
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#756d59">6</span><span><span style=color:#fe8019>...</span>
</span></span></code></pre></div><ul><li>权限定义：`protect control <right>= &lt;rights_expression>
e.g. `protect control xilinx_configuration_visible = &ldquo;false&rdquo;</li><li>条件权限定义：`protect control <right>= <condition>? &lt;true_expression> : &lt;false_expression>
e.g. `protect control decryption = (xilinx_activity==simulation) ? &ldquo;false&rdquo; : &ldquo;true&rdquo;</li></ul><h2 id=rtl加密示例>RTL加密示例</h2><ul><li><strong>VHDL</strong></li></ul><div class=highlight><pre tabindex=0 style=color:#ebdbb2;background-color:#282828;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#756d59"> 1</span><span>`protect version <span style=color:#fe8019>=</span> <span style=color:#d3869b>2</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#756d59"> 2</span><span>`protect begin_commonblock
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#756d59"> 3</span><span>`protect control error_handling <span style=color:#fe8019>=</span> <span style=color:#b8bb26>&#34;delegated&#34;</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#756d59"> 4</span><span>`protect control decryption <span style=color:#fe8019>=</span> (activity<span style=color:#fe8019>==</span>simulation)? <span style=color:#b8bb26>&#34;false&#34;</span> : <span style=color:#b8bb26>&#34;true&#34;</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#756d59"> 5</span><span>`protect end_commonblock
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#756d59"> 6</span><span>`protect begin_toolblock
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#756d59"> 7</span><span>`protect rights_digest_method<span style=color:#fe8019>=</span>”sha256”
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#756d59"> 8</span><span>`protect key_keyowner <span style=color:#fe8019>=</span> “Xilinx”, key_method <span style=color:#fe8019>=</span> <span style=color:#b8bb26>&#34;rsa&#34;</span>, key_keyname <span style=color:#fe8019>=</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#756d59"> 9</span><span><span style=color:#b8bb26>&#34;xilinxt_2019_11&#34;</span>, key_keyowner
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#756d59">10</span><span><span style=color:#fe8019>...</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#756d59">11</span><span>`protect control xilinx_configuration_visible <span style=color:#fe8019>=</span> <span style=color:#b8bb26>&#34;false&#34;</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#756d59">12</span><span>`protect control xilinx_enable_modification <span style=color:#fe8019>=</span> <span style=color:#b8bb26>&#34;false&#34;</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#756d59">13</span><span>`protect control xilinx_enable_probing <span style=color:#fe8019>=</span> <span style=color:#b8bb26>&#34;false&#34;</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#756d59">14</span><span>`protect control decryption <span style=color:#fe8019>=</span> (xilinx_activity<span style=color:#fe8019>==</span>simulation)? <span style=color:#b8bb26>&#34;false&#34;</span> : <span style=color:#b8bb26>&#34;true&#34;</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#756d59">15</span><span>`protect end_toolblock <span style=color:#fe8019>=</span> <span style=color:#b8bb26>&#34;&#34;</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#756d59">16</span><span>`protect begin
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#756d59">17</span><span><span style=color:#fe8019>--</span> Secure Data Block
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#756d59">18</span><span><span style=color:#fe8019>--</span> Protected IP source code <span style=color:#fe8019>is</span> inserted here<span style=color:#fe8019>.</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#756d59">19</span><span><span style=color:#fe8019>...</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#756d59">20</span><span><span style=color:#fe8019>...</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#756d59">21</span><span><span style=color:#fe8019>...</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#756d59">22</span><span>`protect end
</span></span></code></pre></div><ul><li><strong>Verilog/SystemVerilog</strong>
`pragma protect代替`protect</li></ul><div class=highlight><pre tabindex=0 style=color:#ebdbb2;background-color:#282828;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#756d59"> 1</span><span>`pragma protect version <span style=color:#fe8019>=</span> <span style=color:#d3869b>2</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#756d59"> 2</span><span>`pragma protect begin_commonblock
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#756d59"> 3</span><span>`pragma protect control error_handling <span style=color:#fe8019>=</span> <span style=color:#b8bb26>&#34;delegated&#34;</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#756d59"> 4</span><span>`pragma protect control decryption <span style=color:#fe8019>=</span> (activity<span style=color:#fe8019>==</span>simulation)? <span style=color:#b8bb26>&#34;false&#34;</span> : <span style=color:#b8bb26>&#34;true&#34;</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#756d59"> 5</span><span>`pragma protect end_commonblock
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#756d59"> 6</span><span>`pragma protect begin_toolblock
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#756d59"> 7</span><span>`pragma protect rights_digest_method<span style=color:#fe8019>=</span><span style=color:#b8bb26>&#34;sha256&#34;</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#756d59"> 8</span><span>`pragma protect key_keyowner <span style=color:#fe8019>=</span> <span style=color:#b8bb26>&#34;Xilinx&#34;</span>, key_method <span style=color:#fe8019>=</span> <span style=color:#b8bb26>&#34;rsa&#34;</span>, key_keyname <span style=color:#fe8019>=</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#756d59"> 9</span><span><span style=color:#b8bb26>&#34;xilinxt_2019_11&#34;</span>, key_public_key
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#756d59">10</span><span><span style=color:#fe8019>...</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#756d59">11</span><span>`pragma protect control xilinx_configuration_visible <span style=color:#fe8019>=</span> <span style=color:#b8bb26>&#34;false&#34;</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#756d59">12</span><span>`pragma protect control xilinx_enable_modification <span style=color:#fe8019>=</span> <span style=color:#b8bb26>&#34;false&#34;</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#756d59">13</span><span>`pragma protect control xilinx_enable_probing <span style=color:#fe8019>=</span> <span style=color:#b8bb26>&#34;false&#34;</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#756d59">14</span><span>`pragma protect control decryption <span style=color:#fe8019>=</span> (xilinx_activity<span style=color:#fe8019>==</span>simulation)? <span style=color:#b8bb26>&#34;false&#34;</span> : <span style=color:#b8bb26>&#34;true&#34;</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#756d59">15</span><span>`pragma protect end_toolblock <span style=color:#fe8019>=</span> <span style=color:#b8bb26>&#34;&#34;</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#756d59">16</span><span>`pragma protect begin
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#756d59">17</span><span><span style=color:#fe8019>//</span> Secure Data Block
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#756d59">18</span><span><span style=color:#fe8019>//</span> Protected IP source code <span style=color:#fe8019>is</span> inserted here<span style=color:#fe8019>.</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#756d59">19</span><span><span style=color:#fe8019>...</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#756d59">20</span><span><span style=color:#fe8019>...</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#756d59">21</span><span><span style=color:#fe8019>...</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#756d59">22</span><span>`pragma protect end
</span></span></code></pre></div><h2 id=权限对vivado工具影响>权限对vivado工具影响</h2><table><thead><tr><th style=text-align:center>权限/<br>类型</th><th>Simulation</th><th>Synthesis</th><th>Implementation</th></tr></thead><tbody><tr><td style=text-align:center>error_handling/<br>common</td><td><li>delegated = 加密区域内隐藏错误信息引用</li></td><td><li>delegated = 加密区域内隐藏错误信息引用</li></td><td><li>NA</li></td></tr><tr><td style=text-align:center>runtime_visibility/<br>common</td><td><li>delegated = 遵循当前vivado simulator行为-hierarchy viewer隐藏可见性</li></td><td><li>delegated = 遵循当前vivado默认行为-隐藏可见性</li></td><td><li>delegated = 所有名字/层级可见</li></td></tr><tr><td style=text-align:center>child_visibility/<br>common</td><td><li>delegated = 不改变当前simulator行为</li><li>allowed = 展示子模块层级和错误信息</li></td><td><li>delegated = 不改变当前行为</li><li>allowed = 展示子模块层级和错误信息</li></td><td><li>delegated = allowed = 不改变当前implementation行为</li></td></tr><tr><td style=text-align:center>decryption/<br>common</td><td><li>delegated/true = 读入解密文件</li><li>false = 不读入解密文件、报告并停止处理</li></td><td><li>delegated/true = 读入解密文件</li><li>false = 不读入解密文件、报告并停止处理</li></td><td><li>delegated/true = 读入解密文件</li><li>false = 不读入解密文件、报告并停止处理</li></td></tr><tr><td style=text-align:center>xilinx_enable_netlist_export/<br>xilinx-specific</td><td>NA</td><td><li>true = write_vhdl/write_verilog输出网表</li><li>false = write_vhdl/write_verilog不运行</li></td><td><li>true = write_vhdl/write_verilog输出网表</li><li>false = write_vhdl/write_verilog不运行</li></td></tr><tr><td style=text-align:center>xilinx_configuration_visible/<br>xilinx-specific</td><td>NA</td><td><li>true = LUT内容可见</li><li>false = LUT内容不可见</li></td><td><li>true = LUT内容可见</li><li>false = LUT内容不可见</li></td></tr><tr><td style=text-align:center>xilinx_enable_modification/<br>xilinx-specific</td><td>NA</td><td><li>true = 允许修改网表</li><li>false = 不允许修改网表</li></td><td><li>true = 允许修改网表</li><li>false = 不允许修改网表</li></td></tr><tr><td style=text-align:center>xilinx_enable_probing/<br>xilinx-specific</td><td>NA</td><td><li>true = 允许用户在受保护区域插入调试探针</li><li>false = 无法插入调试探针</li></td><td><li>true = 允许用户在受保护区域插入调试探针</li><li>false = 无法插入调试探针</li></td></tr><tr><td style=text-align:center>xilinx_enable_bitstream/<br>xilinx-specific</td><td>NA</td><td>NA</td><td><li>true = 可生成位流</li><li>false = 无法生成位流</li></td></tr><tr><td style=text-align:center>注：NA = 对vivado工具无影响</td><td></td><td></td><td></td></tr></tbody></table><hr><h2 id=vivado加密ip>Vivado加密IP</h2><ul><li><p>tcl命令：<code>encrypt [-key &lt;arg>] -lang &lt;arg> [-quiet] [-verbose] [-ext &lt;arg>] &lt;files>...</code>
e.g. <code>encrypt -lang verilog -ext .vp -key keyfile.txt myip.v</code></p><ul><li><strong>key</strong> - 指定包含Xilinx公钥的RSA密钥文件，如果未指定-key Vivado自动查找密钥。</li><li><strong>lang</strong> - 需加密源文件的HDL语言，支持VHDL或verilog。</li><li><strong>ext</strong> - 输出加密文件的扩展名，如果未指定源文件会被输出文件覆盖。</li><li><strong>&lt;files></strong> - 加密源文件名称</li></ul></li><li><p>Xilinx公钥位置：<code>&lt;Install_Dir>/Vivado/&lt;version>/data/pubkey/</code></p></li><li><p>三方公钥需分别放置在<code>begin_toolblock/end_toolblock</code></p></li></ul><h2 id=vivado加密checkpoint>Vivado加密Checkpoint</h2><ul><li>tcl命令：<code>write_checkpoint [-key &lt;arg>] -encrypt &lt;file></code>
e.g. <code>write_checkpoint -key keyfile.txt -encrypt my_ip.dcp</code><ul><li><strong>key</strong> - 指定秘钥文件</li><li><strong>&lt;files></strong> - 输出dcp文件名称
<em>-encrypt选项只有在写出完整的设计检查点时才有用，-cell结合-encrypt没有作用</em></li></ul></li></ul><hr><h2 id=一些技巧>一些技巧</h2><ul><li>多个IP尽量使用相同的密钥文件来优化结果网表</li><li>使用-ext选项避免无意中覆盖输入文件</li><li>从工具供应商处获取公钥</li><li>在一次调用中加密IP的所有文件</li><li>不要拆分多个加密块/纯文本间的Verilog模块</li><li>在VHDL语言中，将整个实体和体系结构对放入一个加密块</li><li>验证加密代码是否正确加载到Vivado和后续的write_verilog重新加密所有安全设计元素</li><li>验证与三方工具的互操作性</li></ul></div></article></main><aside><div><div><h3>LATEST POSTS</h3></div><div><ul><li><a href=/posts/y2025q2-media-summary/>Y2025Q2 影视音总结</a></li><li><a href=/posts/eda-tool-functionality-modules/>FPGA设计流程与EDA工具架构解析——以Vivado为例</a></li><li><a href=/posts/y2025q1-media-summary/>Y2025Q1 影视音总结</a></li><li><a href=/posts/dfx_key_concepts_and_rules/>DFX中的关键概念与规则</a></li><li><a href=/posts/y2024q4-media-summary/>Y2024Q4 影视音总结</a></li></ul></div></div></aside><footer><p>&copy; 2025 <a href=https://lxulxu.github.io/><b>lxulxu's blog</b></a>.
<a href=https://github.com/lxulxu><b>Github</b></a>.
<a href=https://space.bilibili.com/7739434><b>Bilibili</b></a>.</p></footer></body></html>